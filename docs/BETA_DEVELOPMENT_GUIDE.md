# 🚀 ベータ版開発ガイド

**作成日**: 2025年7月11日  
**対象**: 開発チーム（人間・AI）

---

## 📋 ブランチ戦略

### シンプルな2ブランチ構成
- **master**: 安定版（本番相当）
- **develop**: 開発ブランチ（全員がここで作業）

### 作業方針
- 全員がdevelopブランチで直接作業
- こまめにcommit & push
- コンフリクトは都度解決
- 安定したタイミングでmasterにマージ

---

## 🤝 複数AI協業ガイドライン

### 役割分担

| AI/人間 | 担当領域 | 主要ディレクトリ | 責任範囲 |
|---------|----------|-----------------|----------|
| AI-1 | フロントエンド | `apps/web/` | UI/UX実装、コンポーネント開発 |
| AI-2 | バックエンド | `apps/api/` | API実装、ビジネスロジック |
| AI-3 | インフラ/DevOps | ルート、`.github/` | Docker、CI/CD、監視 |
| 人間 | 設計・レビュー | `docs/` | API仕様定義、スキーマ設計、コードレビュー |

### 作業開始前の必須手順

```bash
# 1. developブランチに切り替え
git checkout develop

# 2. 最新の変更を取得
git pull origin develop

# 3. 作業開始
# こまめにcommit & pushを心がける
```

---

## ⚠️ 競合回避ルール

### 1. 共有ファイルの変更ルール

#### package.json / pnpm-lock.yaml
- **変更前**: チームチャットで事前共有
- **例**: "認証機能のためjsonwebtokenを追加します"
- **推奨**: AI-3またはリードエンジニアが一括管理

#### prisma/schema.prisma
- **必須**: 人間による事前設計レビュー
- **手順**:
  1. 設計案をドキュメント化
  2. レビュー承認を得る
  3. スキーマ変更を実装
  4. マイグレーション実行とテスト

#### 環境変数（.env.example）
- **必須**: 新規追加時は必ずドキュメント化
- **場所**: `docs/ENV_VARIABLES.md`

### 2. API仕様の事前合意

```typescript
// docs/api-contracts/auth.ts
export interface LoginRequest {
  email: string;
  password: string;
}

export interface LoginResponse {
  status: 'success' | 'error';
  data?: {
    token: string;
    user: UserDto;
  };
  message?: string;
}
```

AI-1とAI-2は、この仕様に基づいて独立して開発可能。

---

## 🔄 コミット・プッシュフロー

### 1. 作業前の更新
```bash
# 必ず最新を取得してから作業
git pull origin develop
```

### 2. こまめなコミット
```bash
# 機能の区切りごとにコミット
git add .
git commit -m "feat: ログイン画面のUIを実装"

# すぐにプッシュ
git push origin develop
```

### 3. コミットメッセージ規約
- `feat:` 新機能
- `fix:` バグ修正
- `docs:` ドキュメント
- `style:` フォーマット修正
- `refactor:` リファクタリング
- `test:` テスト追加・修正
- `chore:` ビルド・補助ツール

---

## 📝 日次スタンドアップ（推奨）

### AIへの質問テンプレート
```
1. 昨日完了したタスクは？
2. 今日取り組むタスクは？
3. ブロッカーや相談事項は？
4. 他のAI/人間との連携が必要な箇所は？
```

### 人間の役割
- API仕様の調整
- コンフリクト解決の支援
- アーキテクチャ決定
- コードレビューとマージ承認

---

## 🚨 トラブルシューティング

### コンフリクトが発生した場合
1. `git status`で状況確認
2. 影響範囲が小さければ自分で解決
   ```bash
   # 手動でコンフリクト解決後
   git add .
   git commit -m "fix: merge conflicts"
   git push origin develop
   ```
3. 影響範囲が大きい場合は人間に相談
4. スキーマ変更のコンフリクトは必ず人間がレビュー

### CIが失敗した場合
1. エラーログを確認
2. TypeScriptエラーなら即座に修正
3. テスト失敗なら原因を特定してから修正

### 作業が重複した場合
1. 先にPRを出した方を優先
2. 後の作業者は差分を確認して調整
3. 必要に応じて作業を統合

---

## 📊 進捗管理

### GitHub Projects活用
- カンバンボードで視覚的に管理
- AIもタスクのステータス更新可能
- 週次でベロシティを測定

### 成功の定義
- 日次でdevelopブランチにマージ
- CIパイプラインの成功率95%以上
- コンフリクト発生率10%以下

---

このガイドラインに従うことで、複数のAIと人間が効率的に協業できます。
問題や改善提案があれば、随時このドキュメントを更新してください。