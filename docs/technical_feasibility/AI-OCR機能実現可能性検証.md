# AI-OCR機能実現可能性検証

| Ver | 日付 | 作成 / 変更者 | 変更概要 |
|-----|------|---------------|----------|
| 1.0 | 2025-07-08 | システム管理者 | 初版作成（OCR-001機能検証） |

---

## 1. 検証概要

### 1.1 検証目的
登記簿PDFのAI-OCR機能（OCR-001）の技術的実現可能性を検証し、精度・速度・コスト・セキュリティの観点から最適な技術選定を行う。

### 1.2 検証対象機能
**機能ID**: OCR-001 - 登記簿PDFのAI-OCRと物件マスタへの自動登録

### 1.3 要件サマリー
| 項目 | MVP要件 | RC版要件 |
|------|---------|----------|
| **精度** | 主要15項目で95%以上の正答率 | 98%以上の正答率 |
| **処理時間** | 60秒以内 | 30秒以内 |
| **スループット** | 同時10件処理 | 同時50件処理 |
| **対象** | PDF 1.5以上、推奨300dpi | 同左 |

---

## 2. 総合評価

### 2.1 技術的実現可能性
**結論**: **高い** - 最新のAI技術とクラウドアーキテクチャにより十分実現可能

### 2.2 推奨技術ロードマップ
| フェーズ | 技術選択 | 理由 |
|----------|----------|------|
| **MVP開発** | **Google Cloud Vision API + Gemini** | Google Cloud内完結、セキュリティ優秀、迅速なプロトタイプ開発 |
| **RC版/商用化** | **Vertex AI Document AI Custom Processor** | 98%以上の最高精度、登記簿特化モデル、継続的学習 |

---

## 3. 詳細検証結果

### 3.1 OCR精度検証

#### 3.1.1 技術比較
| 技術 | 精度期待値 | 適用場面 | メリット | デメリット |
|------|------------|----------|----------|-----------|
| **GPT-4o Vision** | 95% | MVP開発 | 高い文脈理解、プロンプトエンジニアリング | 外部サービス依存、コスト高 |
| **Cloud Vision + Gemini** | 95-97% | MVP開発 | Google Cloud完結、速度とコストのバランス | 2段階処理の複雑さ |
| **Document AI Custom** | 98%+ | RC版 | 最高精度、継続学習、特化モデル | 初期開発コスト高、学習データ必要 |

#### 3.1.2 登記簿特有の課題
- **フォーマット多様性**: 発行元・年代による差異
- **手書き文字**: 備考欄等の手書き情報
- **画質問題**: 低解像度・傾き・ノイズ

#### 3.1.3 推奨対策
1. **前処理パイプライン**: OpenCV/Pillowによる傾き補正、ノイズ除去、二値化
2. **多様なサンプル**: 20-30種類の登記簿PDFによる比較検証
3. **段階的精度向上**: ユーザー修正データによる継続学習

### 3.2 処理速度・スループット検証

#### 3.2.1 アーキテクチャ要件
- **非同期処理**: FastAPI + Cloud Tasks/Pub/Sub
- **自動スケーリング**: Cloud Run による動的スケーリング
- **低遅延**: リージョン一致によるネットワーク最適化

#### 3.2.2 スループット実現性
| 項目 | MVP要件 | RC版要件 | 実現方法 |
|------|---------|----------|----------|
| **同時処理** | 10件 | 50件 | Cloud Runの自動スケーリング |
| **処理時間** | 60秒 | 30秒 | 非同期処理 + キューイング |
| **スケーリング** | 基本対応 | 高度な負荷分散 | GKE or Cloud Run |

#### 3.2.3 ボトルネック分析
- **主要ボトルネック**: AIモデルのAPIレスポンス時間
- **対策**: 非同期処理、キューイング、結果キャッシュ
- **監視**: 処理時間、キュー長、スケーリング状況

### 3.3 コスト検証

#### 3.3.1 従量課金制の課題
- **処理量増加**: コストの比例増大
- **高機能モデル**: GPT-4o、Gemini 1.5 Proの高単価
- **予算管理**: 予期しないコスト増加のリスク

#### 3.3.2 コスト最適化戦略
1. **コストシミュレーション**: PoC段階での各サービス単価算出
2. **キャッシュ戦略**: ファイルハッシュベースの結果キャッシュ
3. **予算アラート**: Google Cloud予算アラート設定
4. **効率的な技術選択**: Vision API + Geminiの組み合わせ

### 3.4 セキュリティ検証

#### 3.4.1 セキュリティ要件
- **個人情報保護**: 登記簿に含まれる個人情報の安全な処理
- **データ暗号化**: 保管時・転送時の暗号化
- **アクセス制御**: ロールベースアクセス制御
- **監査ログ**: 処理実行・結果アクセスの完全記録

#### 3.4.2 推奨セキュリティアーキテクチャ
1. **Google Cloud完結**: 外部サービス依存の排除
2. **VPC Service Controls**: サービス境界による保護
3. **IAM最小権限**: 必要最小限の権限設定
4. **暗号化**: CMEK（顧客管理暗号鍵）の検討

---

## 4. 技術選定推奨案

### 4.1 MVP開発（短期）
**推奨技術**: **Google Cloud Vision API + Gemini Flash**

#### 選定理由
- Google Cloud内完結でセキュリティ優秀
- 迅速なプロトタイプ開発が可能
- 95%精度要件を満たす可能性が高い
- コストと速度のバランスが良い

#### 実装アプローチ
1. Cloud Vision APIでテキスト抽出
2. Gemini Flashで構造化データ変換
3. 前処理パイプラインによる精度向上
4. 非同期処理による性能確保

### 4.2 RC版開発（中長期）
**推奨技術**: **Vertex AI Document AI Custom Processor**

#### 選定理由
- 98%以上の最高精度達成可能
- 登記簿特化モデルによる安定性
- ユーザー修正データの継続学習
- 競争優位性の確保

#### 実装アプローチ
1. 登記簿専用カスタムプロセッサ開発
2. 継続的なファインチューニング
3. A/Bテストによるモデル最適化
4. エッジケース対応強化

---

## 5. 実装計画

### 5.1 Phase 1: PoC（2-3週間）
- [ ] サンプルPDF収集（20-30種類）
- [ ] 3技術の比較検証実施
- [ ] 前処理パイプライン開発
- [ ] 精度・速度・コスト測定

### 5.2 Phase 2: MVP開発（4-6週間）
- [ ] Cloud Vision + Gemini実装
- [ ] 非同期処理アーキテクチャ構築
- [ ] セキュリティ機能実装
- [ ] ユーザーインターフェース開発

### 5.3 Phase 3: RC版開発（3-4ヶ月）
- [ ] Document AI Custom Processor開発
- [ ] 継続学習システム構築
- [ ] 高度な監視・運用機能
- [ ] 性能最適化・スケーリング対応

---

## 6. リスクと対策

### 6.1 技術的リスク
| リスク | 影響度 | 対策 |
|--------|---------|------|
| **精度要件未達** | 高 | 複数技術の並行検証、段階的精度向上 |
| **処理速度不足** | 中 | 非同期処理、キューイング、スケーリング |
| **コスト超過** | 中 | 予算アラート、キャッシュ戦略、技術選択最適化 |
| **セキュリティ課題** | 高 | Google Cloud完結、VPC Service Controls |

### 6.2 事業リスク
| リスク | 影響度 | 対策 |
|--------|---------|------|
| **ユーザー満足度低下** | 高 | 信頼度表示、手動修正機能、継続改善 |
| **法的コンプライアンス** | 高 | 個人情報保護法対応、監査ログ、データ保持期間 |
| **競合優位性確保** | 中 | カスタムモデル開発、独自精度向上 |

---

## 7. 成功基準

### 7.1 MVP成功基準
- **認識精度**: 主要項目95%以上の正答率
- **処理時間**: 95パーセンタイルで60秒以内
- **稼働率**: 99.5%以上
- **ユーザー満足度**: 4.0/5.0以上

### 7.2 RC版成功基準
- **認識精度**: 主要項目98%以上の正答率
- **処理時間**: 95パーセンタイルで30秒以内
- **稼働率**: 99.8%以上
- **ユーザー満足度**: 4.4/5.0以上

---

## 8. 次のアクション

### 8.1 即時実行項目
- [ ] 登記簿PDFサンプルの収集開始
- [ ] Google Cloud環境のセットアップ
- [ ] PoC計画の詳細策定

### 8.2 短期実行項目（1-2週間）
- [ ] 技術比較検証の実施
- [ ] 前処理パイプライン開発
- [ ] セキュリティ要件の詳細設計

### 8.3 中期実行項目（1-2ヶ月）
- [ ] MVP実装開始
- [ ] 継続学習システムの設計
- [ ] 運用監視システムの構築

---

## 9. 結論

AI-OCR機能（OCR-001）は**技術的に実現可能**であり、特に以下の点で優れた実現性を示している：

1. **高精度**: Vertex AI Document AIにより98%以上の精度達成可能
2. **高性能**: Cloud Runの自動スケーリングにより要件を満たすスループット実現
3. **セキュリティ**: Google Cloud完結アーキテクチャによる堅牢なセキュリティ
4. **継続改善**: ユーザー修正データによる継続的な精度向上

**最重要事項**: MVP開発ではGoogle Cloud Vision API + Geminiで迅速な価値提供を行い、RC版でDocument AI Custom Processorによる最高精度を実現する段階的アプローチを推奨する。

---

## 10. 関連文書
- [機能仕様書 OCR-001](../機能仕様書/機能仕様書%20OCR-001%20登記簿PDFのAI-OCRと物件マスタへの自動登録.md)
- [技術選定根拠書](../architecture/技術選定根拠書.md)
- [外部連携実現可能性調査結果](外部連携実現可能性調査結果.md)