# 技術的課題とリスク総合評価

| Ver | 日付 | 作成 / 変更者 | 変更概要 |
|-----|------|---------------|----------|
| 1.0 | 2025-07-08 | システム管理者 | 初版作成（技術的実現可能性検証完了後） |

---

## 1. 検証結果サマリー

### 1.1 検証完了項目
✅ **外部連携API調査**: レインズ・ハトサポ・アットホーム連携の実現可能性  
✅ **AI-OCR機能実証**: 実際の登記簿PDFでの高精度処理を確認  
✅ **技術スタック確定**: フロントエンド・バックエンド・インフラ構成  
✅ **法令CI-CDパイプライン調査**: 情報源と自動化の制約を確認

### 1.2 総合評価
**技術的実現可能性**: **高い** - AIを核とした強固なコア機能を実現可能  
**主要リスク**: 外部システム連携（特にRPA依存）とデータソースの不確実性

---

## 2. リスクマトリックス

### 2.1 高リスク項目（即座に対策必要）

| 項目 | リスクレベル | 影響度 | 対策優先度 |
|------|------------|--------|-----------|
| **ハトサポ連携（RPA）** | 🔴 高 | 🔴 高 | 🔴 最優先 |
| **法令CI-CDパイプライン** | 🟠 中-高 | 🔴 高 | 🔴 最優先 |
| **外部API交渉の不確実性** | 🟠 中 | 🟠 中 | 🟠 高 |

### 2.2 中リスク項目（計画的対策）

| 項目 | リスクレベル | 影響度 | 対策優先度 |
|------|------------|--------|-----------|
| **AI API依存リスク** | 🟠 中 | 🟠 中 | 🟠 高 |
| **スケーラビリティ課題** | 🟡 低-中 | 🟠 中 | 🟡 中 |
| **セキュリティ要件** | 🟡 低-中 | 🔴 高 | 🟠 高 |

### 2.3 低リスク項目（継続監視）

| 項目 | リスクレベル | 影響度 | 対策優先度 |
|------|------------|--------|-----------|
| **技術的負債（設計）** | 🟡 低 | 🟡 低 | 🟡 中 |
| **運用・保守の複雑性** | 🟡 低 | 🟡 低 | 🟡 中 |

---

## 3. 詳細リスク分析

### 3.1 🔴 高リスク項目

#### ハトサポ連携（RPA）
**問題**: RPAは外部システムのUI変更に極めて脆弱
- **具体的リスク**: 
  - ハトサポの画面変更により突然動作停止
  - 頻繁なメンテナンスによる運用コスト増大
  - エラー発生時の業務影響（契約書生成不可）
  - 長期的な技術的負債の蓄積

**推奨対策**:
1. **MVPスコープから除外** - 初期リリースでは含めない
2. **代替手段の模索** - ハトサポ提供元へCSV連携等の問い合わせ
3. **内製エンジン開発** - Docxテンプレートベースの契約書生成機能
4. **独立プロジェクト化** - 本体システムと分離した検証・開発

#### 法令CI-CDパイプライン
**問題**: 信頼できる構造化データソースが存在しない
- **具体的リスク**:
  - 法令変更の検知漏れによるコンプライアンス違反
  - 手動更新の解釈ミスによる法的リスク
  - 専門知識を要する継続的な運用負荷

**推奨対策**:
1. **自動化の断念** - MVP段階では手動プロセスで運用
2. **専門家監修体制** - 司法書士等の定期チェック体制構築
3. **限定的監視** - 特定省庁サイトの定期確認に絞る
4. **将来技術の調査** - 政府API・AI技術の進展を継続監視

### 3.2 🟠 中リスク項目

#### 外部API交渉の不確実性
**問題**: レインズ・アットホームとの連携条件が未確定
- **具体的リスク**:
  - API利用コストが想定を大幅に超過
  - 技術仕様が開発前提と相違
  - 交渉遅延によるリリーススケジュール影響

**推奨対策**:
1. **早期交渉開始** - 技術担当者を含む正式協議の即時開始
2. **依存性の抽象化** - Adapterパターンによる疎結合設計
3. **代替機能準備** - API利用不可時の手動入力機能
4. **段階的実装** - 政府APIから順次実装

#### AI API依存リスク
**問題**: Gemini 1.5 Flashへの依存度が高い
- **具体的リスク**:
  - Google API仕様変更・価格改定の影響
  - サービス停止時の業務継続不可
  - 競合サービスとの差別化困難

**推奨対策**:
1. **抽象化レイヤー導入** - プロンプト・入出力の管理層分離
2. **代替AI準備** - Claude、GPT-4o等への切り替え可能性確保
3. **SLA確認** - Google Cloudの稼働率・サポート体制確認
4. **キャッシュ戦略** - 同一処理の重複実行回避

---

## 4. 実装優先度の再評価

### 4.1 Tier 1: 最優先（コア価値の確立）
| 機能 | 理由 | 期間 |
|------|------|------|
| **AI-OCR機能** | 実証済みの高価値機能、外部依存なし | 4-6週間 |
| **抽出結果確認・修正UI** | ユーザビリティの核心、差別化要因 | 2-3週間 |
| **物件情報管理** | OCR結果活用、基本的なデータベース機能 | 3-4週間 |
| **認証・テナント管理** | マルチテナントSaaSの基盤 | 2-3週間 |

### 4.2 Tier 2: 次点（価値拡大・不確実性解消）
| 機能 | 理由 | 期間 |
|------|------|------|
| **政府API連携（レインズ）** | 公開API、比較的低リスク | 3-4週間 |
| **アットホーム連携** | 交渉次第、技術的には実現可能 | 4-5週間 |
| **ダッシュボード機能** | ユーザー価値向上、技術的に安定 | 2-3週間 |

### 4.3 Tier 3: 見送り・別途検討（高リスク機能）
| 機能 | 理由 | 対応方針 |
|------|------|---------|
| **ハトサポ連携（RPA）** | 高リスク、技術的負債の可能性 | 独立プロジェクトとして再検証 |
| **法令CI-CDパイプライン** | 技術的に困難、手動運用が現実的 | 将来技術の動向を監視 |
| **Ordinance Bot** | 法令パイプラインと同様の課題 | 同上 |

---

## 5. 技術アーキテクチャの最適化

### 5.1 推奨アーキテクチャパターン
```
フロントエンド (Vercel)
    ↓ tRPC
メインAPI (Cloud Run - Node.js/Fastify)
    ↓ HTTP/Queue
AI処理ワーカー (Cloud Run - Python/FastAPI)
    ↓
データベース (Cloud SQL - PostgreSQL)
```

### 5.2 重要な設計原則
1. **疎結合設計**: 外部依存を抽象化、差し替え可能な構造
2. **非同期処理**: AI処理の重い処理はキューイング
3. **エラーハンドリング**: 外部API障害時の縮退運転
4. **監視・ログ**: 分散システムの一元的な可視化

---

## 6. セキュリティ要件の実装指針

### 6.1 個人情報保護
- **保管時暗号化**: Cloud SQL、Cloud Storageの自動暗号化
- **転送時暗号化**: TLS 1.3、HTTPS通信の徹底
- **アクセス制御**: IAMによる最小権限原則
- **監査ログ**: 全ての個人情報アクセスを記録

### 6.2 API・サービス間セキュリティ
- **認証**: JWT、OAuth 2.0での厳格な認証
- **認可**: ロールベースアクセス制御（RBAC）
- **APIキー管理**: Secret Managerでの安全な管理
- **ネットワーク保護**: VPC、Identity-Aware Proxyの活用

---

## 7. 開発・運用戦略

### 7.1 リスク軽減戦略
1. **MVP優先**: 低リスク・高価値機能から実装
2. **段階的拡張**: 機能追加は検証後に順次実施
3. **外部交渉並行**: 技術開発と同時に外部協議進行
4. **代替案準備**: 各外部連携の代替手段を事前検討

### 7.2 品質保証戦略
1. **自動テスト**: ユニット・統合・E2Eテスト
2. **継続的インテグレーション**: GitHub Actions等
3. **段階的デプロイ**: ステージング→本番環境
4. **監視・アラート**: パフォーマンス・エラー率の常時監視

---

## 8. コスト・工数の見積もり

### 8.1 開発工数（Tier 1機能）
| 項目 | 工数（人月） | 備考 |
|------|-------------|------|
| **AI-OCR機能** | 2.0-2.5 | UI含む、精度チューニング |
| **認証・テナント管理** | 1.5-2.0 | RBAC、マルチテナント |
| **物件情報管理** | 2.0-2.5 | CRUD、検索、API |
| **インフラ・DevOps** | 1.0-1.5 | CI/CD、監視、セキュリティ |
| **テスト・品質保証** | 1.0-1.5 | 自動テスト、手動テスト |
| **合計** | **7.5-9.5人月** | 3-4名体制で2-3ヶ月 |

### 8.2 運用コスト（月額）
| 項目 | 月額コスト | 備考 |
|------|-----------|------|
| **Google Cloud** | ¥50,000-100,000 | Cloud Run、Cloud SQL、Storage |
| **Vercel** | ¥10,000-30,000 | Pro/Team plan |
| **AI API** | ¥20,000-50,000 | Gemini API従量課金 |
| **監視・ログ** | ¥5,000-10,000 | Cloud Monitoring等 |
| **合計** | **¥85,000-190,000** | 利用規模により変動 |

---

## 9. 成功指標とマイルストーン

### 9.1 技術的成功指標
| 指標 | 目標値 | 測定方法 |
|------|--------|----------|
| **OCR精度** | 95%以上 | 人手確認との一致率 |
| **処理時間** | 60秒以内 | 95パーセンタイル |
| **システム稼働率** | 99.5%以上 | アップタイム監視 |
| **セキュリティ** | 脆弱性ゼロ | 定期的セキュリティ監査 |

### 9.2 プロジェクトマイルストーン
| マイルストーン | 期限 | 成果物 |
|---------------|------|--------|
| **MVP完成** | 3ヶ月後 | OCR機能、基本UI、認証 |
| **外部連携第1弾** | 5ヶ月後 | 政府API連携実装 |
| **本格運用開始** | 6ヶ月後 | 商用環境、監視体制 |

---

## 10. 結論と推奨アクション

### 10.1 総合評価
**不動産売買システムは技術的に実現可能**であり、特にAI-OCR機能を核とした価値提供が確実に実現できる。

### 10.2 最重要推奨アクション
1. **🔴 ハトサポ連携の分離**: MVP機能から除外し、独立検証
2. **🔴 外部API交渉の開始**: レインズ・アットホームとの協議即時開始
3. **🟠 AI-OCR機能の優先開発**: 実証済み機能の製品化に集中
4. **🟠 セキュリティ基盤の早期構築**: 個人情報保護の徹底

### 10.3 リスク管理の要点
- **コア価値への集中**: 外部依存の高い機能は段階的に追加
- **代替案の準備**: 各外部連携の代替手段を常に確保
- **継続的な見直し**: 技術動向と外部環境の変化を定期評価

この戦略により、**リスクを最小化しつつ、システムの強力なコア価値を最速で市場に提供**することが可能となる。

---

## 11. 関連文書
- [外部連携実現可能性調査結果](外部連携実現可能性調査結果.md)
- [AI-OCR機能実現可能性検証](AI-OCR機能実現可能性検証.md)
- [OCR機能実証テスト結果](OCR機能実証テスト結果.md)
- [技術選定根拠書](../architecture/技術選定根拠書.md)
- [非機能要件一覧](../architecture/非機能要件一覧.md)